Tot_PM25_Coal_byYear_bySrc <- tmp2_merge %>%
filter(grepl('[0123456789]', fips)) %>%
group_by(type, year) %>%
summarise(Emissions_sum = sum(Emissions, na.rm = TRUE)) %>%
arrange(type, year)
# Plot total pollutant emissions from coal combustion-related sources by source types over years period ('99, '02, '05, '08)
g2 <-
ggplot(data = Tot_PM25_Coal_byYear_bySrc, aes(x = year, y = Emissions_sum, group = type, colour = type)) +
# geom_line()
geom_point(color = "steelblue") +
geom_smooth(method = "lm") +
facet_grid(. ~ type) +
labs(x = "Year", y = expression("Total" ~ PM[2.5] ~ "Emissions (tons)"), title = expression("Total Coal combustion-related" ~ PM[2.5] ~ "Emissions By Sources")) +
ggsave(filename = "plot4_ByType.png")
print(g2)
multiplot(g1, g2, cols = 2)
# grid.arrange(g1, g2, main = "Title", ncol=2)
# ==--Question 4 --==
# Across the United States, how have emissions from coal combustion-related sources changed from 1999–2008?
# Ans: In general, emissions from coal combustion-related sources has decreased from 1999-2008.
# Using EI.Sector vector to filter for observations with coal combusion-related sources
tmp <- SCC %>%
filter(grepl('Coal', EI.Sector)) %>%
arrange(SCC, Data.Category)
# convert the source type variable [SCC] from Factor to String type
tmp2 <- tmp
tmp2[, "SCC"] <- sapply(tmp2[, "SCC"], as.character)
# Merge tmp2 with NEI dataset by [SCC] variable
tmp2_merge <- semi_join(NEI, tmp2, by = "SCC")
tmp2_merge <- tmp2_merge %>%
group_by(fips, type, year) %>%
arrange(type, year)
# Calculate emissions sum per year
Tot_PM25_Coal_byYear <- tmp2_merge %>%
# filter(grepl('[0123456789]', fips)) %>%
group_by(year) %>%
summarise(Emissions_sum = sum(Emissions, na.rm = TRUE)) %>%
arrange(year)
# Plot total pollutant emissions from coal combustion-related sources over years period ('99, '02, '05, '08)
g1 <-
ggplot(Tot_PM25_Coal_byYear, aes(x=year, y=Emissions_sum)) +
# g1 + geom_line()
geom_point(color = "steelblue") +
geom_smooth(method = "lm") +
labs(x = "Year", y = expression("Total" ~ PM[2.5] ~ "Emissions (tons)"), title = expression("Total Coal combustion-related" ~ PM[2.5] ~ "Emissions")) +
ggsave(filename = "plot4_Total.png")
print (g1)
# Calculate emissions sum per year by source type
Tot_PM25_Coal_byYear_bySrc <- tmp2_merge %>%
filter(grepl('[0123456789]', fips)) %>%
group_by(type, year) %>%
summarise(Emissions_sum = sum(Emissions, na.rm = TRUE)) %>%
arrange(type, year)
# Plot total pollutant emissions from coal combustion-related sources by source types over years period ('99, '02, '05, '08)
g2 <-
ggplot(data = Tot_PM25_Coal_byYear_bySrc, aes(x = year, y = Emissions_sum, group = type, colour = type)) +
# geom_line()
geom_point(color = "steelblue") +
geom_smooth(method = "lm") +
facet_grid(. ~ type) +
labs(x = "Year", y = expression("Total" ~ PM[2.5] ~ "Emissions (tons)"), title = expression("Total Coal combustion-related" ~ PM[2.5] ~ "Emissions By Sources")) +
ggsave(filename = "plot4_ByType.png")
print(g2)
g3 <- multiplot(g1, g2, cols = 2)
print (g3)
grid.arrange(g1, g2)
grid.arrange(g1, g2)
g3 <- arrangeGrob(g1, g2)
ggsave(filename = "plot4.png", g3)
# ==--Question 4 --==
# Across the United States, how have emissions from coal combustion-related sources changed from 1999–2008?
# Ans: In general, emissions from coal combustion-related sources has decreased in years 1999-2008.  However, emissions from Point source has seen a decrease in years 1999-2008, while Non-Point source maintained relatively the same emission level.
# Using EI.Sector vector to filter for observations with coal combusion-related sources
tmp <- SCC %>%
filter(grepl('Coal', EI.Sector)) %>%
arrange(SCC, Data.Category)
# convert the source type variable [SCC] from Factor to String type
tmp2 <- tmp
tmp2[, "SCC"] <- sapply(tmp2[, "SCC"], as.character)
# Merge tmp2 with NEI dataset by [SCC] variable
tmp2_merge <- semi_join(NEI, tmp2, by = "SCC")
tmp2_merge <- tmp2_merge %>%
group_by(fips, type, year) %>%
arrange(type, year)
# Calculate emissions sum per year
Tot_PM25_Coal_byYear <- tmp2_merge %>%
# filter(grepl('[0123456789]', fips)) %>%
group_by(year) %>%
summarise(Emissions_sum = sum(Emissions, na.rm = TRUE)) %>%
arrange(year)
# Plot total pollutant emissions from coal combustion-related sources over years period ('99, '02, '05, '08)
g1 <-
ggplot(Tot_PM25_Coal_byYear, aes(x=year, y=Emissions_sum)) +
# g1 + geom_line()
geom_point(color = "steelblue") +
geom_smooth(method = "lm") +
labs(x = "Year", y = expression("Total" ~ PM[2.5] ~ "Emissions (tons)"), title = expression("Total Coal combustion-related" ~ PM[2.5] ~ "Emissions")) +
ggsave(filename = "plot4_Total.png")
print (g1)
# Calculate emissions sum per year by source type
Tot_PM25_Coal_byYear_bySrc <- tmp2_merge %>%
filter(grepl('[0123456789]', fips)) %>%
group_by(type, year) %>%
summarise(Emissions_sum = sum(Emissions, na.rm = TRUE)) %>%
arrange(type, year)
# Plot total pollutant emissions from coal combustion-related sources by source types over years period ('99, '02, '05, '08)
g2 <-
ggplot(data = Tot_PM25_Coal_byYear_bySrc, aes(x = year, y = Emissions_sum, group = type, colour = type)) +
# geom_line()
geom_point(color = "steelblue") +
geom_smooth(method = "lm") +
facet_grid(. ~ type) +
labs(x = "Year", y = expression("Total" ~ PM[2.5] ~ "Emissions (tons)"), title = expression("Total Coal combustion-related" ~ PM[2.5] ~ "Emissions By Sources")) +
ggsave(filename = "plot4_ByType.png")
print(g2)
# Combining both plots (emissions sum per yr and emissions sum per yr per source) into single canvas
grid.arrange(g1, g2)
g3 <- arrangeGrob(g1, g2)
ggsave(filename = "plot4.png", g3)
# Using multiplot function
# g3 <- multiplot(g1, g2, cols = 2)
# print (g3)
Tot_PM25_atBmore_OnRoad <- NEI %>%
filter((type == "ON-ROAD") & (fips == "24510")) %>%
group_by(year) %>%
summarise(Emissions_sum = sum(Emissions, na.rm = TRUE)) %>%
arrange(year)
# Plot emmissions from motor vehicle sources changed from 1999–2008 in Baltimore City
g1 <-
ggplot(data = Tot_PM25_atBmore_OnRoad, aes(x = year, y = Emissions_sum)) +
geom_line() +
labs(x = "Year", y = expression("Total" ~ PM[2.5] ~ "Emissions (tons)"), title = expression("Total Vehicles related" ~ PM[2.5] ~ "Emissions in Baltimore")) +
ggsave(filename = "plot5_gen.png")
print (g1)
Tot_PM25_atBmore_OnRoad_bySrc <- NEI %>%
filter((type == "ON-ROAD") & (fips == "24510")) %>%
group_by(type, year) %>%
summarise(Emissions_sum = sum(Emissions, na.rm = TRUE)) %>%
arrange(type, year)
# Plot emmissions from motor vehicle sources changed from 1999–2008 in Baltimore City
g2 <-
ggplot(data = Tot_PM25_atBmore_OnRoad, aes(x = year, y = Emissions_sum, group = type, colour = type)) +
geom_line() +
labs(x = "Year", y = expression("Total" ~ PM[2.5] ~ "Emissions (tons)"), title = expression("Total Vehicles related" ~ PM[2.5] ~ "Emissions in Baltimore")) +
ggsave(filename = "plot5_type.png")
print (g2)
Tot_PM25_atBmore_OnRoad_bySrc <- NEI %>%
filter((type == "ON-ROAD") & (fips == "24510")) %>%
group_by(type, year) %>%
summarise(Emissions_sum = sum(Emissions, na.rm = TRUE)) %>%
arrange(type, year)
# Plot emmissions from motor vehicle sources changed from 1999–2008 in Baltimore City
g2 <-
ggplot(data = Tot_PM25_atBmore_OnRoad_bySrc, aes(x = year, y = Emissions_sum, group = type, colour = type)) +
geom_line() +
labs(x = "Year", y = expression("Total" ~ PM[2.5] ~ "Emissions (tons)"), title = expression("Total Vehicles related" ~ PM[2.5] ~ "Emissions in Baltimore")) +
ggsave(filename = "plot5_type.png")
print (g2)
Tot_PM25_atBmore_OnRoad <- NEI %>%
filter((type == "ON-ROAD") & (fips == "24510")) %>%
group_by(year) %>%
summarise(Emissions_sum = sum(Emissions, na.rm = TRUE)) %>%
arrange(year)
# Plot emmissions from motor vehicle sources changed from 1999–2008 in Baltimore City
g <-
ggplot(data = Tot_PM25_atBmore_OnRoad, aes(x = year, y = Emissions_sum)) +
geom_line() +
labs(x = "Year", y = expression("Total" ~ PM[2.5] ~ "Emissions (tons)"), title = expression("Total Vehicles related" ~ PM[2.5] ~ "Emissions in Baltimore")) +
ggsave(filename = "plot5.png")
print (g)
# ==--Question 5 --==
# How have emissions from motor vehicle sources changed from 1999–2008 in Baltimore City?
# Ans: A logarithmic decrease
Tot_PM25_atBmore_OnRoad <- NEI %>%
filter((type == "ON-ROAD") & (fips == "24510")) %>%
group_by(year) %>%
summarise(Emissions_sum = sum(Emissions, na.rm = TRUE)) %>%
arrange(year)
# Plot emmissions from motor vehicle sources changed from 1999–2008 in Baltimore City
g <-
ggplot(data = Tot_PM25_atBmore_OnRoad, aes(x = year, y = Emissions_sum)) +
geom_line() +
labs(x = "Year", y = expression("Total" ~ PM[2.5] ~ "Emissions (tons)"), title = expression("Total Vehicles related" ~ PM[2.5] ~ "Emissions in Baltimore City, MD")) +
ggsave(filename = "plot5.png")
print (g)
Tot_PM25_Bmore_LA <- NEI %>%
filter ((type == "ON-ROAD") & ((fips == "24510") | (fips == "06037"))) %>%
group_by (fips, year) %>%
summarise(Emissions_sum = sum(Emissions, na.rm = TRUE)) %>%
arrange(fips, year)
# Plot emissions from motor vehicle sources in Baltimore City with emissions from motor vehicle sources in Los Angeles County, CA
g <-
ggplot(data = Tot_PM25_Bmore_LA, aes(x = year, y = Emissions_sum, group = fips, colour = fips)) +
geom_line() +
labs(x = "Year", y = expression("Total" ~ PM[2.5] ~ "Emissions (tons)"), title = expression("Total Coal combustion-related" ~ PM[2.5] ~ "Emissions By Sources btw Baltimore & LA")) +
ggsave(filename = "plot6.png")
print (g)
g <-
ggplot(data = Tot_PM25_Bmore_LA, aes(x = year, y = Emissions_sum, group = fips, colour = fips)) +
geom_line() +
labs(x = "Year", y = expression("Total" ~ PM[2.5] ~ "Emissions (tons)"), title = expression("Total" ~ PM[2.5] ~ "Emissions from vehicles sources between Baltimore & LA")) +
ggsave(filename = "plot6.png")
print (g)
g <-
ggplot(data = Tot_PM25_Bmore_LA, aes(x = year, y = Emissions_sum, group = fips, colour = fips)) +
geom_line() +
labs(x = "Year", y = expression("Total" ~ PM[2.5] ~ "Emissions (tons)"), title = expression("Total" ~ PM[2.5] ~ "Emissions from vehicles sources between Baltimore & LA"), labs(colour = "City")) +
ggsave(filename = "plot6.png")
print (g)
g <-
ggplot(data = Tot_PM25_Bmore_LA, aes(x = year, y = Emissions_sum, group = fips, colour = fips)) +
geom_line() +
labs(x = "Year", y = expression("Total" ~ PM[2.5] ~ "Emissions (tons)"), title = expression("Total" ~ PM[2.5] ~ "Emissions from vehicles sources between Baltimore & LA"), labs = "City") +
ggsave(filename = "plot6.png")
print (g)
g <-
ggplot(data = Tot_PM25_Bmore_LA, aes(x = year, y = Emissions_sum, group = fips, colour = fips)) +
geom_line() +
labs(x = "Year", y = expression("Total" ~ PM[2.5] ~ "Emissions (tons)"), title = expression("Total" ~ PM[2.5] ~ "Emissions from vehicles sources between Baltimore & LA"), labs = "City") +
guide_legend(title = "City") +
ggsave(filename = "plot6.png")
print (g)
g <-
ggplot(data = Tot_PM25_Bmore_LA, aes(x = year, y = Emissions_sum, group = fips, colour = fips), guide_legend(title = "City")) +
geom_line() +
labs(x = "Year", y = expression("Total" ~ PM[2.5] ~ "Emissions (tons)"), title = expression("Total" ~ PM[2.5] ~ "Emissions from vehicles sources between Baltimore & LA"), labs = "City") +
ggsave(filename = "plot6.png")
print (g)
g <-
ggplot(data = Tot_PM25_Bmore_LA, aes(x = year, y = Emissions_sum, group = fips, colour = fips)) +
geom_line() +
labs(x = "Year", y = expression("Total" ~ PM[2.5] ~ "Emissions (tons)"), title = expression("Total" ~ PM[2.5] ~ "Emissions from vehicles sources between Baltimore & LA"), labs = "City") +
ggsave(filename = "plot6.png")
print (g)
View(Tot_PM25_Bmore_LA)
Tot_PM25_Bmore_LA %<%
filter((year = 1999) & (fips = "24510"))
Tot_PM25_Bmore_LA %>%
filter((year = 1999) & (fips = "24510"))
Tot_PM25_Bmore_LA %>%
filter((year = "1999") & (fips = "24510"))
Tot_PM25_Bmore_LA %>%
filter((year == 1999) & (fips == "24510"))
Tot_PM25_Bmore_LA %>%
filter((year == 1999) & (fips == "24510")) %>%
select(Emissions_sum)
Emiss_1999_Bmore <- Tot_PM25_Bmore_LA %>%
filter((year == 1999) & (fips == "24510")) %>%
select(Emissions_sum)
Emiss_1999_LA <- Tot_PM25_Bmore_LA %>%
filter((year == 1999) & (fips == "06037")) %>%
select(Emissions_sum)
tmp <- SCC %>%
filter(grepl('[Cc]oal', EI.Sector)) %>%
arrange(SCC, Data.Category)
# convert the source type variable [SCC] from Factor to String type
tmp2 <- tmp
tmp2[, "SCC"] <- sapply(tmp2[, "SCC"], as.character)
# Merge tmp2 with NEI dataset by [SCC] variable
tmp2_merge <- semi_join(NEI, tmp2, by = "SCC")
tmp2_merge <- tmp2_merge %>%
group_by(fips, type, year) %>%
arrange(type, year)
Tot_PM25_Bmore_LA <- NEI %>%
filter ((type == "ON-ROAD") & ((fips == "24510") | (fips == "06037"))) %>%
group_by (fips, year) %>%
summarise(Emissions_sum = sum(Emissions, na.rm = TRUE)) %>%
arrange(fips, year)
# Plot emissions from motor vehicle sources in Baltimore City with emissions from motor vehicle sources in Los Angeles County, CA
g <-
ggplot(data = Tot_PM25_Bmore_LA, aes(x = year, y = Emissions_sum, group = fips, colour = fips)) +
geom_line() +
labs(x = "Year", y = expression("Total" ~ PM[2.5] ~ "Emissions (tons)"), title = expression("Total" ~ PM[2.5] ~ "Emissions from vehicles sources between Baltimore & LA"), labs = "City") +
ggsave(filename = "plot6.png")
print (g)
Emiss_1999_Bmore <- Tot_PM25_Bmore_LA %>%
filter((year == 1999) & (fips == "24510")) %>%
select(Emissions_sum)
Emiss_1999_LA <- Tot_PM25_Bmore_LA %>%
filter((year == 1999) & (fips == "06037")) %>%
select(Emissions_sum)
View(Emiss_1999_Bmore)
View(Emiss_1999_LA)
Tot_PM25_Bmore_LA %>%
select(everything())
Std_PM25_Bmore_LA <- Tot_PM25_Bmore_LA %>%
# filter(fips = "24510") %>%
select(everything()) %>%
mutate(
Emissions_std =
ifelse(fips = "24510",
Emissions_sum / Emiss_1999_Bmore,
0
),
Emissions_std =
ifelse(fips = "06037",
Emissions_sum / Emiss_1999_LA,
0
)
)
View(Tot_PM25_Bmore_LA)
glimpse(Tot_PM25_Bmore_LA)
glimpse(Emiss_1999_Bmore)
Std_PM25_Bmore_LA <- Tot_PM25_Bmore_LA %>%
# filter(fips = "24510") %>%
select(everything()) %>%
mutate(
Emissions_std = ifelse(
fips == "24510",
Emissions_sum / Emiss_1999_Bmore,
0
),
Emissions_std = ifelse(
fips == "06037",
Emissions_sum / Emiss_1999_LA,
0
)
)
Tot_PM25_Bmore_LA %>%
select(everything()) %>%
filter(fips == "24510") %>%
mutate(Emissions_std = Emissions_sum / Emiss_1999_Bmore)
Std_PM25_Bmore_LA <- transform(
Tot_PM25_Bmore_LA,
Emissions_std = ifelse(
fips == "24510",
Emissions_sum / Emiss_1999_Bmore,
Emissions_sum / Emiss_1999_LA
)
)
Emiss_1999_Bmore <- Tot_PM25_Bmore_LA %>%
filter((year == 1999) & (fips == "24510")) %>%
select(Emissions_sum)
Emiss_1999_LA <- Tot_PM25_Bmore_LA %>%
filter((year == 1999) & (fips == "06037")) %>%
select(Emissions_sum)
Tot_PM25_Bmore_LA <- Tot_PM25_Bmore_LA %>%
select(everything()) %>%
mutate(Emiss_1999 = ifelse(
fips == "24510",
Emiss_1999_Bmore,
0
)
)
View(Emiss_1999_LA)
View(Emiss_1999_Bmore)
Emiss_1999_Bmore <- Tot_PM25_Bmore_LA %>%
filter((year == 1999) & (fips == "24510")) %>%
select(Emissions_sum)
Emiss_1999_LA <- Tot_PM25_Bmore_LA %>%
filter((year == 1999) & (fips == "06037")) %>%
select(Emissions_sum)
Tot_PM25_Bmore_LA <- Tot_PM25_Bmore_LA %>%
select(everything()) %>%
mutate(
Emiss_1999 = ifelse(fips == "06037", 3931.12, 0),
Emiss_1999 = ifelse(fips == "06037", 346.82, 0)
)
View(Tot_PM25_Bmore_LA)
Emiss_1999_Bmore <- Tot_PM25_Bmore_LA %>%
filter((year == 1999) & (fips == "24510")) %>%
select(Emissions_sum)
Emiss_1999_LA <- Tot_PM25_Bmore_LA %>%
filter((year == 1999) & (fips == "06037")) %>%
select(Emissions_sum)
Tot_PM25_Bmore_LA <- Tot_PM25_Bmore_LA %>%
select(everything()) %>%
mutate(
Emiss_1999 = ifelse(fips == "06037", 3931.12, 0),
Emiss_1999 = ifelse(fips == "24510", 346.82, 0)
)
View(Tot_PM25_Bmore_LA)
Emiss_1999_Bmore <- Tot_PM25_Bmore_LA %>%
filter((year == 1999) & (fips == "24510")) %>%
select(Emissions_sum)
Emiss_1999_LA <- Tot_PM25_Bmore_LA %>%
filter((year == 1999) & (fips == "06037")) %>%
select(Emissions_sum)
Tot_PM25_Bmore_LA <- Tot_PM25_Bmore_LA %>%
select(everything()) %>%
mutate(Emiss_1999 = ifelse(fips == "06037", 3931.12, 346.82))
View(Tot_PM25_Bmore_LA)
Emiss_1999_Bmore <- Tot_PM25_Bmore_LA %>%
filter((year == 1999) & (fips == "24510")) %>%
select(Emissions_sum)
Emiss_1999_LA <- Tot_PM25_Bmore_LA %>%
filter((year == 1999) & (fips == "06037")) %>%
select(Emissions_sum)
# dplyr doesn't seems to allow assignment of observation from global variable (outside dataset)
Tot_PM25_Bmore_LA <- Tot_PM25_Bmore_LA %>%
select(everything()) %>%
mutate(Emiss_1999 = ifelse(fips == "06037", 3931.12, 346.82))
# Calculate emission measure standardised to year 1999 value for each fips (city)
Tot_PM25_Bmore_LA <- Tot_PM25_Bmore_LA %>%
select(everything()) %>%
mutate(Emissions_std = Emissions_sum / Emiss_1999)
View(Tot_PM25_Bmore_LA)
# Standardised to year 1999's observation
Emiss_1999_Bmore <- Tot_PM25_Bmore_LA %>%
filter((year == 1999) & (fips == "24510")) %>%
select(Emissions_sum)
Emiss_1999_LA <- Tot_PM25_Bmore_LA %>%
filter((year == 1999) & (fips == "06037")) %>%
select(Emissions_sum)
# dplyr doesn't seems to allow assignment of observation from global variable (outside dataset)
Std_PM25_Bmore_LA <- Tot_PM25_Bmore_LA %>%
select(everything()) %>%
mutate(Emiss_1999 = ifelse(fips == "06037", 3931.12, 346.82))
# Calculate emission measure standardised to year 1999 value for each fips (city)
Std_PM25_Bmore_LA <- Std_PM25_Bmore_LA %>%
select(everything()) %>%
mutate(Emissions_std = Emissions_sum / Emiss_1999)
# Plot
g2 <-
ggplot(data = Std_PM25_Bmore_LA, aes(x = year, y = Emissions_sum, group = fips, colour = fips)) +
geom_line() +
labs(x = "Year", y = expression("Total" ~ PM[2.5] ~ "Emissions (tons)"), title = expression("Total" ~ PM[2.5] ~ "Emissions from vehicles sources between Baltimore & LA"), labs = "City") +
ggsave(filename = "plot6.png")
print (g2)
View(Std_PM25_Bmore_LA)
# Standardised to year 1999's observation
Emiss_1999_Bmore <- Tot_PM25_Bmore_LA %>%
filter((year == 1999) & (fips == "24510")) %>%
select(Emissions_sum)
Emiss_1999_LA <- Tot_PM25_Bmore_LA %>%
filter((year == 1999) & (fips == "06037")) %>%
select(Emissions_sum)
# dplyr doesn't seems to allow assignment of observation from global variable (outside dataset)
Std_PM25_Bmore_LA <- Tot_PM25_Bmore_LA %>%
select(everything()) %>%
mutate(Emiss_1999 = ifelse(fips == "06037", 3931.12, 346.82))
# Calculate emission measure standardised to year 1999 value for each fips (city)
Std_PM25_Bmore_LA <- Std_PM25_Bmore_LA %>%
select(everything()) %>%
mutate(Emissions_std = Emissions_sum / Emiss_1999)
# Plot
g2 <-
ggplot(data = Std_PM25_Bmore_LA, aes(x = year, y = Emissions_std, group = fips, colour = fips)) +
geom_line() +
labs(x = "Year", y = expression("Total" ~ PM[2.5] ~ "Emissions (tons)"), title = expression("Total" ~ PM[2.5] ~ "Emissions from vehicles sources between Baltimore & LA"), labs = "City") +
ggsave(filename = "plot6.png")
print (g2)
View(Std_PM25_Bmore_LA)
View(Std_PM25_Bmore_LA)
View(Tot_PM25_Bmore_LA)
# Standardised to year 1999's observation
Emiss_1999_Bmore <- Tot_PM25_Bmore_LA %>%
filter((year == 1999) & (fips == "24510")) %>%
select(Emissions_sum)
Emiss_1999_LA <- Tot_PM25_Bmore_LA %>%
filter((year == 1999) & (fips == "06037")) %>%
select(Emissions_sum)
# dplyr doesn't seems to allow assignment of observation from global variable (outside dataset)
Tot_PM25_Bmore_LA <- Tot_PM25_Bmore_LA %>%
select(everything()) %>%
mutate(Emiss_1999 = ifelse(fips == "06037", 3931.12, 346.82))
# Calculate emission measure standardised to year 1999 value for each fips (city)
Tot_PM25_Bmore_LA <- Tot_PM25_Bmore_LA %>%
select(everything()) %>%
mutate(Emissions_std = Emissions_sum / Emiss_1999)
# Plot
g2 <-
ggplot(data = Tot_PM25_Bmore_LA, aes(x = year, y = Emissions_std, group = fips, colour = fips)) +
geom_line() +
labs(x = "Year", y = expression("Total" ~ PM[2.5] ~ "Emissions (tons)"), title = expression("Total" ~ PM[2.5] ~ "Emissions from vehicles sources between Baltimore & LA"), labs = "City") +
ggsave(filename = "plot6.png")
print (g2)
View(Tot_PM25_Bmore_LA)
# ==--Question 6 --==
# Compare emissions from motor vehicle sources in Baltimore City with emissions from motor vehicle sources in Los Angeles County, California (fips == "06037"). Which city has seen greater changes over time in motor vehicle emissions?
# Ans:
Tot_PM25_Bmore_LA <- NEI %>%
filter ((type == "ON-ROAD") & ((fips == "24510") | (fips == "06037"))) %>%
group_by (fips, year) %>%
summarise(Emissions_sum = sum(Emissions, na.rm = TRUE)) %>%
arrange(fips, year)
# Plot emissions from motor vehicle sources in Baltimore City with emissions from motor vehicle sources in Los Angeles County, CA
g1 <-
ggplot(data = Tot_PM25_Bmore_LA, aes(x = year, y = Emissions_sum, group = fips, colour = fips)) +
geom_line() +
labs(x = "Year", y = expression("Total" ~ PM[2.5] ~ "Emissions (tons)"), title = expression("Total" ~ PM[2.5] ~ "Emissions from vehicles sources between Baltimore & LA"), labs = "City") +
ggsave(filename = "plot6_orig.png")
print (g1)
# Standardised to year 1999's observation
Emiss_1999_Bmore <- Tot_PM25_Bmore_LA %>%
filter((year == 1999) & (fips == "24510")) %>%
select(Emissions_sum)
Emiss_1999_LA <- Tot_PM25_Bmore_LA %>%
filter((year == 1999) & (fips == "06037")) %>%
select(Emissions_sum)
# dplyr doesn't seems to allow assignment of observation from global variable (outside dataset)
Tot_PM25_Bmore_LA <- Tot_PM25_Bmore_LA %>%
select(everything()) %>%
mutate(Emiss_1999 = ifelse(fips == "06037", 3931.12, 346.82))
# Calculate emission measure standardised to year 1999 value for each fips (city)
Tot_PM25_Bmore_LA <- Tot_PM25_Bmore_LA %>%
select(everything()) %>%
mutate(Emissions_std = Emissions_sum / Emiss_1999)
# Plot
g2 <-
ggplot(data = Tot_PM25_Bmore_LA, aes(x = year, y = Emissions_std, group = fips, colour = fips)) +
geom_line() +
labs(x = "Year", y = expression("Total" ~ PM[2.5] ~ "Emissions (tons)"), title = expression("Total" ~ PM[2.5] ~ "Emissions from vehicles sources between Baltimore & LA"), labs = "City") +
ggsave(filename = "plot6_std.png")
print (g2)
# Combining both plots (emissions sum per yr and emissions sum per yr per source) into single canvas
grid.arrange(g1, g2)
g3 <- arrangeGrob(g1, g2)
ggsave(filename = "plot6.png", g3)
# Using multiplot function
# g3 <- multiplot(g1, g2, cols = 2)
# print (g3)
